The code uses a Gaussian distribution to generate the random field and works for all values of standard deviation (R).
If the H vs M curve gets cut at the edges, this generally happens for high values of R, increase the range of the external field.
The code generates and plots 2000 points of magnetization and external field.
For 1000 spins, it takes 84.33 seconds to run the complete code.
Zoom in to see the fine structure and jumps in the plot.
