The code uses a Gaussian distribution to generate the random field and works for all values of R.
If the H vs M curve gets cut at the edges, this generally happens for high values of R, increasing the number of elements of the external field.
Reference:
[1] Kuntz, Matthew C., et al. "Hysteresis, avalanches, and noise." Computing in science & engineering 1.4 (1999): 73-81.
