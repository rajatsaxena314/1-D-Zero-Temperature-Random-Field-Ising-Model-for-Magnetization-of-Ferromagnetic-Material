The code uses a Gaussian distribution to generate the random field and works for all values of R.
If the H vs M curve gets cut at the edges, this generaly happens for high values of R, increase the number of elements of the external field.
Reference:
[1] Kuntz, Matthew C., et al. "Hysteresis, avalanches, and noise." Computing in science & engineering 1.4 (1999): 73-81.
[2] https://guava.physics.uiuc.edu/~nigel/courses/563/Essays_2008/PDF/Friedman.pdf
