The code uses a Gaussian distribution to generate the random field and works for all values of R.
If the H vs M curve gets cut at the edges, this generally happens for high values of R, increasing the number of elements of the external field
